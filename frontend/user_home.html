<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>My Hub â€” ScheduleApp</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://unpkg.com/lucide@latest"></script>

<style>
  :root{ 
    --text:#ffffff; 
    --muted:rgba(255, 255, 255, 0.6); 
    --accent:#38bdf8; /* Sky Blue */
    --accent-purple:#c084fc; /* Purple */
    --success:#4ade80;
    --danger:#fb7185;
    --warning:#facc15;
    
    --glass: rgba(255, 255, 255, 0.05);
    --glass-hover: rgba(255, 255, 255, 0.08);
    --border: rgba(255, 255, 255, 0.08);
    --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4);
  }
  
  /* DARKER, RICHER BACKGROUND */
  body { 
    background: linear-gradient(135deg, #020617 0%, #111030 50%, #2e1065 100%);
    background-attachment: fixed;
    color: var(--text); 
    font-family: 'Inter', sans-serif; 
    min-height: 100vh; 
  }
  
  .container { max-width: 1000px; margin: 0 auto; padding: 32px 24px; }
  
  /* Header */
  header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
  .logo { font-weight: 800; font-size: 24px; display:flex; gap:12px; align-items:center; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.2); }
  .logo-img { width: 32px; height: 32px; border-radius: 8px; object-fit: contain; box-shadow: 0 0 15px rgba(56, 189, 248, 0.5); }
  
  .logout { 
    color: var(--muted); font-size: 14px; cursor: pointer; transition: 0.2s; 
    display:flex; align-items:center; gap:6px; padding: 8px 16px; border-radius: 20px;
    background: rgba(0,0,0,0.3); border: 1px solid transparent;
  }
  .logout:hover { color: white; background: rgba(255,255,255,0.1); border-color: var(--border); }

  /* GLASS TABS */
  .nav-tabs { display: flex; gap: 12px; margin-bottom: 32px; padding: 4px; background: rgba(0,0,0,0.3); border-radius: 24px; width: fit-content; border: 1px solid var(--border); backdrop-filter: blur(10px); }
  .tab-btn {
    background: transparent; border: none; color: var(--muted); 
    padding: 8px 20px; font-size: 14px; font-weight: 600; border-radius: 20px;
    cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 8px;
  }
  .tab-btn:hover { color: white; background: rgba(255,255,255,0.05); }
  .tab-btn.active { background: rgba(255,255,255,0.15); color: white; border: 1px solid var(--border); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }

  /* SECTIONS */
  .section-content { display: none; animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
  .section-content.active { display: block; }

  /* GLASS CARDS */
  .card { 
    background: var(--glass); 
    border: 1px solid var(--border); 
    border-radius: 16px; padding: 24px; margin-bottom: 24px; 
    backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
    box-shadow: var(--shadow);
  }
  
  .grid-2 { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 24px; align-items: start; }
  
  /* 1. OVERVIEW SECTION STYLES */
  .welcome-banner { margin-bottom: 24px; }
  .welcome-title { font-size: 32px; font-weight: 800; color: white; margin-bottom: 4px; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
  .welcome-sub { color: var(--muted); font-size: 16px; }

  /* Next Up Hero */
  .next-up-hero {
    background: linear-gradient(135deg, rgba(56, 189, 248, 0.15), rgba(192, 132, 252, 0.05));
    border: 1px solid rgba(56, 189, 248, 0.2);
    padding: 32px; border-radius: 20px; margin-bottom: 32px;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    position: relative; overflow: hidden;
    display: flex; justify-content: space-between; align-items: center;
  }
  .next-up-hero::before {
      content:''; position: absolute; top:0; left:0; width:4px; height:100%; background: var(--accent);
  }
  .hero-label { font-size: 12px; text-transform: uppercase; letter-spacing: 2px; color: var(--accent); font-weight: 700; margin-bottom: 8px; display: flex; align-items: center; gap: 6px; }
  .hero-time { font-family: 'Inter', sans-serif; font-size: 14px; color: rgba(255,255,255,0.7); display:flex; align-items:center; gap:8px; margin-top: 6px; }

  /* Workspaces & Items */
  .team-item {
    display: flex; align-items: center; justify-content: space-between;
    padding: 20px; background: rgba(255,255,255,0.03); border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.08); cursor: pointer; transition: all 0.2s ease; margin-bottom: 16px;
  }
  .team-item:hover { 
    border-color: var(--accent); 
    background: linear-gradient(90deg, rgba(56, 189, 248, 0.1), rgba(255,255,255,0.03));
    transform: translateY(-4px); 
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
  }
  .team-left { display: flex; align-items: center; gap: 16px; }
  .team-icon { width: 52px; height: 52px; background: rgba(255,255,255,0.05); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 24px; border: 1px solid var(--border); flex-shrink: 0; }
  .team-info h4 { font-size: 16px; font-weight: 700; margin-bottom: 2px; color: white; }
  .team-info span { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; }

  /* Action Buttons Grid - Rearranged */
  .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }
  
  /* Primary Action Buttons (Emphasized) */
  .action-btn-primary {
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px;
    padding: 16px; border-radius: 12px; 
    background: linear-gradient(145deg, rgba(56, 189, 248, 0.1), rgba(124, 92, 255, 0.05));
    border: 1px solid rgba(56, 189, 248, 0.2); 
    color: white; cursor: pointer; transition: 0.2s;
    font-size: 12px; font-weight: 700; text-align: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  .action-btn-primary:hover {
    background: linear-gradient(145deg, rgba(56, 189, 248, 0.2), rgba(124, 92, 255, 0.1));
    border-color: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(56, 189, 248, 0.15);
  }
  .action-btn-primary i { color: var(--accent); }

  /* Secondary Large Action (Full Width) */
  .action-btn-full {
    grid-column: span 2; /* Takes full width */
    display: flex; align-items: center; justify-content: center; gap: 10px;
    padding: 14px; border-radius: 12px; border: 1px solid var(--border);
    background: rgba(255,255,255,0.02); color: var(--muted); 
    cursor: pointer; transition: 0.2s; font-size: 13px; font-weight: 600;
  }
  .action-btn-full:hover { 
    background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.3); 
    transform: translateY(-2px); color: white; 
  }

  /* Activity List */
  .activity-list { display: flex; flex-direction: column; gap: 16px; }
  .activity-item { display: flex; gap: 16px; align-items: start; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
  .activity-item:last-child { border-bottom: none; padding-bottom: 0; }
  .act-icon { width: 32px; height: 32px; border-radius: 50%; background: rgba(56, 189, 248, 0.1); border: 1px solid rgba(56, 189, 248, 0.2); display: flex; align-items: center; justify-content: center; color: var(--accent); flex-shrink: 0; }
  .act-content { font-size: 13px; color: var(--muted); line-height: 1.4; }
  .act-content b { color: white; font-weight: 600; }
  .act-time { font-size: 11px; color: rgba(255,255,255,0.3); margin-top: 4px; }

  /* 2. CALENDAR SECTION STYLES */
  .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
  .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
  .cal-day-name { text-align: center; color: var(--muted); font-size: 12px; font-weight: 600; padding-bottom: 8px; }
  .cal-date { 
    height: 48px; border-radius: 8px; background: rgba(255,255,255,0.03); 
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    font-size: 13px; color: var(--muted); cursor: pointer; transition: 0.2s;
    position: relative; border: 1px solid transparent;
  }
  .cal-date:hover { background: rgba(255,255,255,0.1); color: white; border-color: var(--border); }
  .cal-date.active { background: var(--accent); color: #000; font-weight: 700; box-shadow: 0 0 15px rgba(56, 189, 248, 0.4); }
  .cal-dots { display: flex; gap: 3px; margin-top: 4px; }
  .dot { width: 4px; height: 4px; border-radius: 50%; }

  /* Event Details Card in Calendar */
  .event-detail-card {
      background: rgba(255,255,255,0.05); border-left: 4px solid var(--accent);
      border-radius: 8px; padding: 16px; margin-bottom: 12px;
      animation: fadeIn 0.3s ease; position: relative;
  }
  .event-detail-meta {
      display: flex; gap: 16px; margin-top: 8px; color: var(--muted); font-size: 12px; align-items: center;
  }
  .event-desc { font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 8px; line-height: 1.4; border-top: 1px solid var(--border); padding-top: 8px; }

  /* 3. PROFILE SECTION STYLES */
  .profile-header { display: flex; align-items: flex-start; gap: 24px; margin-bottom: 32px; }
  .profile-avatar-lg { width: 100px; height: 100px; border-radius: 50%; background: rgba(0,0,0,0.3); border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 32px; color: var(--muted); overflow: hidden; cursor: pointer; position: relative; box-shadow: 0 8px 24px rgba(0,0,0,0.3); flex-shrink: 0; }
  .profile-avatar-lg:hover::after { content:'Edit'; position: absolute; inset:0; background:rgba(0,0,0,0.6); font-size:12px; display:flex; align-items:center; justify-content:center; color:white; font-weight: 600; }
  
  .profile-info-edit { flex: 1; display: flex; flex-direction: column; gap: 12px; }
  .profile-field-group { display: flex; flex-direction: column; gap: 4px; }
  .profile-label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 700; }
  
  .profile-input { 
      background: rgba(0,0,0,0.2); border: 1px solid var(--border); 
      border-radius: 8px; padding: 8px 12px; color: white; font-size: 14px; width: 100%;
  }
  .profile-input:focus { outline: none; border-color: var(--accent); background: rgba(0,0,0,0.4); }
  .profile-input.title { font-size: 20px; font-weight: 700; padding: 4px 0; background: transparent; border: none; border-bottom: 1px solid transparent; border-radius: 0; }
  .profile-input.title:focus { border-bottom-color: var(--accent); }

  /* Status Badge Button */
  .status-btn {
      font-size:11px; padding:6px 14px; border-radius:20px; 
      border:1px solid transparent; font-weight:600; cursor: pointer; transition: 0.2s;
      display: inline-flex; align-items: center; gap: 6px; width: fit-content;
  }
  .status-btn.active { background:rgba(56,189,248,0.15); color:var(--accent); border-color:rgba(56,189,248,0.3); }
  .status-btn.busy { background:rgba(251,113,133,0.15); color:var(--danger); border-color:rgba(251,113,133,0.3); }
  .status-btn.offline { background:rgba(148,163,184,0.15); color:var(--muted); border-color:rgba(148,163,184,0.3); }
  
  /* Availability Grid (Split Shift Support) */
  .avail-grid { display: flex; flex-direction: column; gap: 12px; }
  .avail-row { 
      display: flex; justify-content: space-between; align-items: flex-start; 
      padding: 16px; background: rgba(255,255,255,0.03); 
      border-radius: 12px; border: 1px solid var(--border); transition: 0.2s;
  }
  .avail-row:hover { border-color: var(--accent-purple); background: rgba(255,255,255,0.05); }
  .avail-day { font-weight: 700; font-size: 14px; color: white; width: 50px; padding-top: 10px; }
  
  .avail-intervals { flex: 1; display: flex; flex-direction: column; gap: 8px; }
  .interval-group { display: flex; align-items: center; gap: 8px; }
  
  /* FIXED: Added color-scheme: dark so clock icon is white/visible */
  .avail-input { 
      background: rgba(0,0,0,0.4); border: 1px solid var(--border); 
      color: white; padding: 8px; border-radius: 8px; 
      font-family: monospace; font-size: 13px; width: 110px; text-align: center;
      color-scheme: dark; /* CRITICAL FIX */
  }
  .avail-input:focus { border-color: var(--accent); outline: none; }
  
  .btn-icon-small { width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.05); color: var(--muted); cursor: pointer; border: 1px solid transparent; transition: 0.2s; }
  .btn-icon-small:hover { background: rgba(255,255,255,0.1); color: white; }
  .btn-add { color: var(--success); background: rgba(74, 222, 128, 0.1); }
  .btn-remove { color: var(--danger); }

  /* Utility */
  .section-title { font-size: 16px; font-weight: 600; color: white; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
  .btn { padding: 10px 16px; border-radius: 8px; font-weight: 600; font-size: 13px; cursor: pointer; border: none; display: flex; align-items: center; gap: 8px; transition: 0.2s; }
  .btn-primary { background: white; color: #000; box-shadow: 0 4px 15px rgba(255,255,255,0.2); }
  .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }
  .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--muted); }
  .btn-outline:hover { border-color: white; color: white; background: rgba(255,255,255,0.05); }
  
  @keyframes fadeIn { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
  @media(max-width: 900px) { .grid-2 { grid-template-columns: 1fr; } }
</style>
</head>
<body>

<div class="container">
    <header>
        <div class="logo">
           <img src="LOGO.png" alt="Logo" class="logo-img">
           ScheduleApp
        </div>
        <div class="logout" onclick="window.location.href='login.html'">
           <i data-lucide="log-out" width="16"></i> <span class="hidden sm:inline">Sign Out</span>
        </div>
    </header>

    <!-- TAB NAVIGATION -->
    <div class="nav-tabs">
        <button class="tab-btn active" onclick="switchTab('overview', this)">
            <i data-lucide="layout-dashboard" width="16"></i> Overview
        </button>
        <button class="tab-btn" onclick="switchTab('calendar', this)">
            <i data-lucide="calendar" width="16"></i> Calendar
        </button>
        <button class="tab-btn" onclick="switchTab('profile', this)">
            <i data-lucide="user" width="16"></i> Profile
        </button>
    </div>

    <!-- 1. OVERVIEW SECTION -->
    <div id="overview" class="section-content active">
        
        <div class="welcome-banner">
            <h1 class="welcome-title" id="welcomeMsg">Welcome back</h1>
            <p class="welcome-sub">Dashboard &bull; <span id="currentDateDisplay"></span></p>
        </div>

        <!-- Hero: Next Meeting (Full Width) -->
        <div class="next-up-hero">
            <div>
                <div class="hero-label">
                    <i data-lucide="zap" width="14" fill="var(--accent)"></i> Happening Next
                </div>
                <div style="font-size: 32px; font-weight: 800; color: white; margin-bottom: 8px; letter-spacing: -0.5px;">Client Demo Review</div>
                <div class="hero-time">
                    <span style="background:rgba(56, 189, 248, 0.1); color:var(--accent); padding:4px 8px; border-radius:6px; font-weight:600; font-size:13px;">
                        Oct 24 &bull; 2:00 PM - 3:00 PM
                    </span>
                    <span style="color:rgba(255,255,255,0.5);">|</span>
                    <span style="display:flex; align-items:center; gap:4px;"><i data-lucide="map-pin" width="14"></i> Alpha Squad Workspace</span>
                </div>
            </div>
            <div style="text-align:right;">
                <button class="btn btn-primary" onclick="goToCalendar()">View Details</button>
            </div>
        </div>

        <div class="grid-2">
            <!-- Left: Workspaces & Actions -->
            <div>
                <div class="section-title"><i data-lucide="briefcase" width="18" style="color:var(--accent);"></i> My Workspaces</div>
                
                <div class="team-item" onclick="window.location.href='dashboard.html?role=Admin'">
                    <div class="team-left">
                        <div class="team-icon" style="color:#c084fc;">ðŸš€</div>
                        <div class="team-info">
                            <h4>Alpha Squad</h4>
                            <span>Admin / Owner</span>
                        </div>
                    </div>
                    <i data-lucide="chevron-right" width="20" color="var(--muted)"></i>
                </div>

                <div class="team-item" onclick="window.location.href='member_dashboard.html'">
                    <div class="team-left">
                        <div class="team-icon" style="color:#38bdf8;">ðŸ’Š</div>
                        <div class="team-info">
                            <h4>MediCare Team</h4>
                            <span>Member</span>
                        </div>
                    </div>
                    <i data-lucide="chevron-right" width="20" color="var(--muted)"></i>
                </div>

                <!-- Emphasized Action Cards -->
                <div class="section-title" style="margin-top:24px;"><i data-lucide="rocket" width="18" style="color:white;"></i> Grow Your Network</div>
                
                <div class="action-grid">
                    <!-- High Emphasis Primary Actions -->
                    <div class="action-btn-primary" onclick="window.location.href='create_team.html'">
                        <i data-lucide="plus-circle" width="24"></i> Create Team
                    </div>
                    <div class="action-btn-primary" onclick="window.location.href='join_team.html'">
                        <i data-lucide="users" width="24"></i> Join Team
                    </div>
                    
                    <!-- Secondary Utility Button (Full Width) -->
                    <div class="action-btn-full" onclick="goToProfile()">
                        <i data-lucide="clock" width="16" style="color:var(--accent-purple);"></i> Edit My Availability
                    </div>
                </div>
            </div>

            <!-- Right: Activity & Notes -->
            <div>
                <div class="section-title"><i data-lucide="activity" width="18" style="color:var(--accent-purple);"></i> Updates</div>
                
                <div class="card" style="padding: 20px;">
                    <div class="activity-list">
                        <div class="activity-item">
                            <div class="act-icon"><i data-lucide="users" width="14"></i></div>
                            <div>
                                <div class="act-content"><b>Sarah</b> joined Alpha Squad.</div>
                                <div class="act-time">10 mins ago</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="act-icon"><i data-lucide="calendar" width="14"></i></div>
                            <div>
                                <div class="act-content">Schedule conflict resolved.</div>
                                <div class="act-time">2 hours ago</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-title"><i data-lucide="sticky-note" width="18" style="color:var(--muted);"></i> Quick Notes</div>
                <div class="card" style="padding:16px;">
                    <div style="display:flex; gap:8px; margin-bottom:12px;">
                        <input type="text" id="noteInput" placeholder="Add reminder..." style="background:rgba(0,0,0,0.3); border:1px solid var(--border); padding:8px; border-radius:6px; width:100%; color:white; font-size:13px;">
                        <button onclick="addNote()" style="background:var(--accent); color:black; border:none; border-radius:6px; width:36px; cursor:pointer;"><i data-lucide="plus" width="16"></i></button>
                    </div>
                    <div id="noteList" style="display:flex; flex-direction:column; gap:8px;">
                        <!-- Notes go here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 2. CALENDAR SECTION -->
    <div id="calendar" class="section-content">
        <div class="card">
            <div class="calendar-header">
                <div style="font-size: 20px; font-weight: 800; color: white;" id="calMonthYear">October 2023</div>
                <div style="display:flex; gap:8px;">
                    <button class="btn btn-outline" style="padding: 6px 10px;" onclick="changeMonth(-1)"><i data-lucide="chevron-left" width="16"></i></button>
                    <button class="btn btn-outline" style="padding: 6px 10px;" onclick="changeMonth(1)"><i data-lucide="chevron-right" width="16"></i></button>
                </div>
             </div>
             
             <div class="calendar-grid" id="calendarGrid">
                <!-- JS Injected -->
             </div>
             
             <div id="dateDetails" style="margin-top: 24px; padding-top:24px; border-top:1px solid var(--border); display:none;">
                 <h4 style="color:white; font-size:14px; margin-bottom:16px; font-weight:600;">Events on <span id="selectedDateText"></span></h4>
                 <div id="eventsContainer"></div>
             </div>
        </div>
    </div>

    <!-- 3. PROFILE SECTION -->
    <div id="profile" class="section-content">
        
        <!-- Profile Identity & Customization -->
        <div class="card">
            <div class="profile-header">
                <div class="profile-avatar-lg" onclick="document.getElementById('fileInput').click()">
                    <img id="avatarImg" src="" style="display:none; width:100%; height:100%; object-fit:cover;">
                    <span id="avatarInitials">U</span>
                </div>
                <div class="profile-info-edit">
                    <!-- Name & Title -->
                    <div class="profile-field-group">
                        <input type="text" id="userName" class="profile-input title" value="User Name" oninput="saveNameLocal()" placeholder="Your Name">
                        <input type="text" class="profile-input" placeholder="Job Title (e.g. Senior Developer)" style="background:transparent; border:none; padding:0; color:var(--muted); font-size:13px;">
                    </div>
                    
                    <!-- Details Grid -->
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px; width:100%;">
                        <div>
                            <label class="profile-label">Email</label>
                            <input type="text" class="profile-input" value="user@example.com" readonly style="opacity:0.7; cursor:not-allowed;">
                        </div>
                        <div>
                            <label class="profile-label">Location</label>
                            <input type="text" class="profile-input" placeholder="e.g. New York, USA">
                        </div>
                    </div>

                    <!-- Status -->
                    <div>
                        <label class="profile-label" style="display:block; margin-bottom:4px;">Current Status</label>
                        <button id="statusBtn" class="status-btn active" onclick="toggleStatus()">
                            <span class="dot" style="background:currentColor; width:6px; height:6px;"></span> Active
                        </button>
                    </div>
                </div>
            </div>
            
            <div style="padding-top:16px; border-top:1px solid var(--border);">
                <label class="profile-label">Bio / About</label>
                <textarea class="profile-input" rows="2" placeholder="Share a bit about yourself..." style="resize:none; margin-top:4px;"></textarea>
            </div>

            <input type="file" id="fileInput" hidden accept="image/*" onchange="updateAvatar(this)">
        </div>

        <!-- SPLIT-SHIFT AVAILABILITY -->
        <div class="section-title"><i data-lucide="clock" width="18" style="color:#ffffff;"></i> Weekly Availability (Split Shifts)</div>
        <div class="card" id="availContainerCard">
            <div style="margin-bottom:16px; font-size:13px; color:var(--muted);">
                Set your recurring availability. You can add multiple time slots for split shifts.
            </div>
            <div class="avail-grid" id="availContainer">
                <!-- JS Generated -->
            </div>
            <button class="btn btn-primary" style="margin-top:20px; width:100%;" onclick="alert('Schedule Updated!')">Save Changes</button>
        </div>

    </div>

</div>

<script>
    lucide.createIcons();

    // --- Tab Switching ---
    function switchTab(tabId, btn) {
        document.querySelectorAll('.section-content').forEach(el => el.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        if(btn) btn.classList.add('active');
    }

    function goToCalendar() {
        const calBtn = document.querySelectorAll('.tab-btn')[1]; 
        switchTab('calendar', calBtn);
    }

    function goToProfile() {
        const profBtn = document.querySelectorAll('.tab-btn')[2];
        switchTab('profile', profBtn);
        setTimeout(() => {
            document.getElementById('availContainerCard').scrollIntoView({behavior: 'smooth'});
        }, 100);
    }

    // --- Date Display ---
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    document.getElementById('currentDateDisplay').innerText = new Date().toLocaleDateString('en-US', options);

    // --- Profile Logic ---
    const storedName = localStorage.getItem('sa_username');
    if(storedName) {
        document.getElementById('userName').value = storedName;
        document.getElementById('avatarInitials').innerText = storedName.charAt(0).toUpperCase();
        updateGreeting(storedName);
    } else {
        updateGreeting('User');
    }

    function saveNameLocal() {
        const val = document.getElementById('userName').value;
        localStorage.setItem('sa_username', val);
        document.getElementById('avatarInitials').innerText = val.charAt(0).toUpperCase();
        updateGreeting(val);
    }

    function updateGreeting(name) {
        const hour = new Date().getHours();
        let timeGreet = 'Good morning';
        if(hour >= 12) timeGreet = 'Good afternoon';
        if(hour >= 18) timeGreet = 'Good evening';
        document.getElementById('welcomeMsg').innerText = `${timeGreet}, ${name.split(' ')[0]}`;
    }

    function updateAvatar(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('avatarImg').src = e.target.result;
                document.getElementById('avatarImg').style.display = 'block';
                document.getElementById('avatarInitials').style.display = 'none';
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    // --- Status Toggle Logic ---
    const statuses = ['active', 'busy', 'offline'];
    let currentStatusIdx = 0;
    
    function toggleStatus() {
        currentStatusIdx = (currentStatusIdx + 1) % statuses.length;
        const s = statuses[currentStatusIdx];
        const btn = document.getElementById('statusBtn');
        
        // Reset classes
        btn.className = 'status-btn';
        
        if(s === 'active') {
            btn.classList.add('active');
            btn.innerHTML = `<span class="dot" style="background:currentColor; width:6px; height:6px;"></span> Active`;
        } else if (s === 'busy') {
            btn.classList.add('busy');
            btn.innerHTML = `<span class="dot" style="background:currentColor; width:6px; height:6px;"></span> Busy`;
        } else {
            btn.classList.add('offline');
            btn.innerHTML = `<span class="dot" style="background:currentColor; width:6px; height:6px;"></span> Offline`;
        }
    }

    // --- Quick Notes ---
    function addNote() {
        const val = document.getElementById('noteInput').value;
        if(!val) return;
        const div = document.createElement('div');
        div.style.cssText = "font-size:13px; padding:8px; background:rgba(255,255,255,0.05); border-radius:6px; color:var(--muted); display:flex; justify-content:space-between; align-items:center;";
        div.innerHTML = `<span>${val}</span> <i data-lucide="x" width="12" style="cursor:pointer" onclick="this.parentElement.remove()"></i>`;
        document.getElementById('noteList').prepend(div);
        document.getElementById('noteInput').value = '';
        lucide.createIcons();
    }

    // --- SPLIT SHIFT AVAILABILITY LOGIC ---
    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];
    const availContainer = document.getElementById('availContainer');
    
    // Initial Render
    days.forEach(day => {
        const dayShort = day.substring(0,3);
        const div = document.createElement('div');
        div.className = 'avail-row';
        div.innerHTML = `
            <div class="avail-day">${dayShort}</div>
            <div class="avail-intervals" id="intervals-${dayShort}">
                <!-- Default 1 Slot -->
                <div class="interval-group">
                    <input type="time" class="avail-input" value="09:00">
                    <span style="color:var(--muted)">-</span>
                    <input type="time" class="avail-input" value="17:00">
                    <button class="btn-icon-small btn-add" onclick="addInterval('${dayShort}')"><i data-lucide="plus" width="14"></i></button>
                </div>
            </div>
        `;
        availContainer.appendChild(div);
    });

    window.addInterval = function(dayShort) {
        const container = document.getElementById(`intervals-${dayShort}`);
        const group = document.createElement('div');
        group.className = 'interval-group';
        group.innerHTML = `
            <input type="time" class="avail-input">
            <span style="color:var(--muted)">-</span>
            <input type="time" class="avail-input">
            <button class="btn-icon-small btn-remove" onclick="this.parentElement.remove()"><i data-lucide="trash-2" width="14"></i></button>
        `;
        container.appendChild(group);
        lucide.createIcons();
    }

    // --- Calendar Logic ---
    let currDate = new Date();
    const EVENTS_DB = {
        5: [{title: 'Team Sync', time: '10:00 AM - 11:00 AM', location: 'Alpha HQ Room A', color: 'blue', desc: 'Monthly sync to discuss roadmap and KPIs.'}],
        12: [{title: 'Weekly Standup', time: '10:00 AM - 10:30 AM', location: 'Zoom Meeting', color: 'blue', desc: 'Quick check-in on sprint progress.'}],
        15: [{title: 'Design Review', time: '02:00 PM - 03:30 PM', location: 'Figma Comments', color: 'purple', desc: 'Reviewing the new dashboard mockups.'}],
        24: [{title: 'Client Demo', time: '09:00 AM - 10:00 AM', location: 'Google Meet', color: 'blue', desc: 'Presenting the beta version to the client.'}],
    };

    function changeMonth(dir) {
        currDate.setMonth(currDate.getMonth() + dir);
        renderCalendar();
    }

    function renderCalendar() {
       const grid = document.getElementById('calendarGrid');
       document.getElementById('calMonthYear').innerText = currDate.toLocaleDateString('en-US', {month:'long', year:'numeric'});
       grid.innerHTML = '';
       
       ['Mo','Tu','We','Th','Fr','Sa','Su'].forEach(d => grid.innerHTML += `<div class="cal-day-name">${d}</div>`);
       
       const year = currDate.getFullYear();
       const month = currDate.getMonth();
       const firstDay = new Date(year, month, 1).getDay();
       const adjFirstDay = firstDay === 0 ? 6 : firstDay - 1;
       const daysInMonth = new Date(year, month + 1, 0).getDate();

       for(let i=0; i<adjFirstDay; i++) grid.innerHTML += `<div></div>`;

       const today = new Date();
       const isCurrentMonth = today.getMonth() === month && today.getFullYear() === year;

       for(let i=1; i<=daysInMonth; i++) {
          let dots = '';
          if(EVENTS_DB[i]) {
              dots = '<div class="cal-dots">';
              EVENTS_DB[i].forEach(ev => dots += `<div class="dot" style="background:${ev.color === 'blue' ? '#38bdf8' : '#c084fc'}"></div>`);
              dots += '</div>';
          }
          const isToday = isCurrentMonth && i === today.getDate() ? 'border:1px solid var(--accent);' : '';
          
          const el = document.createElement('div');
          el.className = 'cal-date';
          if(isToday) el.style.borderColor = 'var(--accent)';
          el.innerHTML = `${i} ${dots}`;
          el.onclick = () => showDetails(i);
          grid.appendChild(el);
       }
    }

    function showDetails(day) {
        document.getElementById('dateDetails').style.display = 'block';
        document.getElementById('selectedDateText').innerText = `${currDate.toLocaleString('default', {month:'short'})} ${day}`;
        const container = document.getElementById('eventsContainer');
        container.innerHTML = '';
        
        if(EVENTS_DB[day]) {
            EVENTS_DB[day].forEach(ev => {
                const accentColor = ev.color === 'blue' ? '#38bdf8' : '#c084fc';
                container.innerHTML += `
                    <div class="event-detail-card" style="border-left-color:${accentColor};">
                        <div style="color:white; font-size:16px; font-weight:700;">${ev.title}</div>
                        <div class="event-detail-meta">
                            <span style="display:flex; align-items:center; gap:6px;">
                                <i data-lucide="clock" width="14" color="${accentColor}"></i> ${ev.time}
                            </span>
                            <span style="display:flex; align-items:center; gap:6px;">
                                <i data-lucide="map-pin" width="14" color="${accentColor}"></i> ${ev.location}
                            </span>
                        </div>
                        <div class="event-desc">
                            ${ev.desc}
                        </div>
                    </div>
                `;
            });
            lucide.createIcons();
        } else {
            container.innerHTML = `<div style="color:var(--muted); font-size:13px; font-style:italic; padding:8px;">No events scheduled for this day.</div>`;
        }
    }

    renderCalendar();

</script>
</body>
</html>